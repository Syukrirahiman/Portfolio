{"ast":null,"code":"var _jsxFileName = \"/Users/syukrirahiman/OneDrive - Singapore Management University/React/movieapp/src/Showtimes.js\";\nimport React from 'react';\nimport './Showtimes.css';\nimport { Table, Jumbotron, Container, Row, Col, Button } from 'react-bootstrap'; // import Button from '@material-ui/core/Button';\n\nimport { MDBCardImage } from \"mdbreact\";\n\nclass Showtimes extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cinema: this.props.location.state.cinema,\n      movie_id: this.props.location.state.movie_id,\n      result: [],\n      cinema_id: '',\n      city_id: '',\n      apikeyIS: '5ogMBOJo2nty7v7YNku1eZkxHEAdEJMK',\n      apikeyOMDB: '9e790f8b',\n      imdbid: '',\n      movie_details: {}\n    };\n  }\n\n  componentDidMount() {\n    this.getData();\n  }\n\n  handleChange(event) {\n    const target = event.target;\n    const value = target.value; // this.setState({\n    //     value : value,\n    //     redirect: true,\n    //   });\n\n    this.setState({\n      destination_value: this.state.cinema_arr[value],\n      redirect: true\n    }); // console.log(this.state);\n    // console.log(this.state.value.location);\n  }\n\n  render() {\n    // this.displayShowtimes()\n    const result = this.state.result;\n    const bold = {\n      fontWeight: 'bold'\n    };\n    const center = {\n      textAlign: 'center'\n    };\n    console.log(result);\n    return React.createElement(\"div\", {\n      id: \"showtime\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(Jumbotron, {\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(MDBCardImage, {\n      className: \"img-fluid pb-3 float-left\",\n      src: this.state.movie_details.Poster,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    })), React.createElement(Col, {\n      xs: 7,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, this.state.movie_details.Title), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, \"Release date:\"), \"  \", this.state.movie_details.Released, \"  \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, \"IMDB Rating:\"), \"  \", this.state.movie_details.imdbRating, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, \"Runtime:\"), \"  \", this.state.movie_details.Runtime, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, \"Rated:\"), \"  \", this.state.movie_details.Rated, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \"Genre:\"), \"  \", this.state.movie_details.Genre, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, \"Director:\"), \"  \", this.state.movie_details.Director, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"Production:\"), \"  \", this.state.movie_details.Production, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \" \", React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Language:\"), \"  \", this.state.movie_details.Language, \" \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      style: bold,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"Plot:\"), \" \", this.state.movie_details.Plot))))), React.createElement(\"div\", {\n      className: \"table1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, this.state.movie_details.Title, \" showtimes at \", this.state.cinema, \" \"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      variant: \"dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, \"#\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, \"Timeslot\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, this.state.result.map((value, index) => React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, index + 1), React.createElement(\"td\", {\n      colSpan: \"2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, value.start_at), React.createElement(\"td\", {\n      style: center,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"outline-light\",\n      value: value.booking_link,\n      onClick: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"Book Now\")))))))) // this.displayShowtimes()\n    ; // this.displayShowtimes()\n  }\n\n  getData() {\n    var xhr = new XMLHttpRequest();\n    var cinema_name = this.state.cinema;\n    let urlCinemas = \"https://api.internationalshowtimes.com/v4/cinemas/?apikey=\" + this.state.apikeyIS;\n    var movie_id = this.state.movie_id;\n    xhr.addEventListener('load', () => {\n      // update the state of the component with the result here\n      var resp = JSON.parse(xhr.responseText);\n\n      for (let i = 0; i < resp.cinemas.length; i++) {\n        var cinema = resp.cinemas[i];\n\n        if (cinema_name.toLowerCase() == cinema.name.toLowerCase()) {\n          this.setState({\n            cinema_id: cinema.id,\n            city_id: cinema.city_id\n          });\n        }\n      }\n\n      console.log(this.state);\n      var xhr2 = new XMLHttpRequest();\n      var city_id = this.state.city_id;\n      console.log(city_id);\n      console.log(movie_id); //get showtimes\n\n      let urlShowtimes = \"https://api.internationalshowtimes.com/v4/showtimes?city_ids=\" + city_id + \"&movie_id=\" + movie_id + \"&apikey=\" + this.state.apikeyIS;\n      xhr2.addEventListener('load', () => {\n        // update the state of the component with the result here\n        var result_arr = [];\n        var resp = JSON.parse(xhr2.responseText);\n        console.log(this.state.cinema_id);\n        console.log(movie_id);\n\n        for (let i = 0; i < resp.showtimes.length; i++) {\n          var showtime = resp.showtimes[i]; // console.log(showtime);\n\n          if (showtime.cinema_id == this.state.cinema_id && showtime.movie_id == movie_id) {\n            result_arr.push(showtime);\n          }\n        }\n\n        console.log(result_arr);\n        this.setState({\n          result: result_arr\n        });\n      });\n      xhr2.open('GET', urlShowtimes);\n      xhr2.send();\n      console.log(this.state);\n    });\n    xhr.open('GET', urlCinemas);\n    xhr.send(); // get movie details\n\n    var xhr3 = new XMLHttpRequest();\n    let urlmoviedetails = \"https://api.internationalshowtimes.com/v4/movies/\" + movie_id + \"?fields=imdb_id&apikey=\" + this.state.apikeyIS;\n    xhr3.addEventListener('load', () => {\n      // update the state of the component with the result here\n      var resp = JSON.parse(xhr3.responseText);\n      this.setState({\n        imdbid: resp.movie.imdb_id\n      });\n      console.log(this.state.imdbid);\n      var xhr4 = new XMLHttpRequest(); //get movie details from imdb\n\n      let urlMovieDetails = \"http://www.omdbapi.com/?i=\" + this.state.imdbid + \"&apikey=\" + this.state.apikeyOMDB;\n      xhr4.addEventListener('load', () => {\n        // update the state of the component with the result here\n        var resp = JSON.parse(xhr4.responseText);\n        this.setState({\n          movie_details: resp\n        });\n        console.log(this.state);\n      });\n      xhr4.open('GET', urlMovieDetails);\n      xhr4.send();\n    });\n    xhr3.open('GET', urlmoviedetails);\n    xhr3.send();\n  }\n\n  displayShowtimes() {\n    // this.getData();\n    let r = this.state.result;\n    var test = '';\n    var result = \"<table> <tr> <th>S/No</th> <th>Time</th></tr>\";\n    console.log(r);\n\n    for (let i = 0; i < r.length; i++) {\n      result += \"<tr><td>\" + (i + 1) + \"</td><td>\" + r[i].start_at + \"</td></tr>\";\n      test += i + 1 + \" \" + r[i].start_at + \" \";\n    }\n\n    result += \"</table>\"; // return \"<div id  = 'showtime' dangerouslySetInnerHTML={{__html:\"+result+'}}></div>'\n\n    return result; // this.document.getElementById(\"showtime\").innerHTML = result;\n  }\n\n}\n\nexport default Showtimes;","map":{"version":3,"sources":["/Users/syukrirahiman/OneDrive - Singapore Management University/React/movieapp/src/Showtimes.js"],"names":["React","Table","Jumbotron","Container","Row","Col","Button","MDBCardImage","Showtimes","Component","constructor","props","state","cinema","location","movie_id","result","cinema_id","city_id","apikeyIS","apikeyOMDB","imdbid","movie_details","componentDidMount","getData","handleChange","event","target","value","setState","destination_value","cinema_arr","redirect","render","bold","fontWeight","center","textAlign","console","log","Poster","Title","Released","imdbRating","Runtime","Rated","Genre","Director","Production","Language","Plot","map","index","start_at","booking_link","xhr","XMLHttpRequest","cinema_name","urlCinemas","addEventListener","resp","JSON","parse","responseText","i","cinemas","length","toLowerCase","name","id","xhr2","urlShowtimes","result_arr","showtimes","showtime","push","open","send","xhr3","urlmoviedetails","movie","imdb_id","xhr4","urlMovieDetails","displayShowtimes","r","test"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nimport './Showtimes.css'\r\n\r\nimport { Table, Jumbotron, Container, Row, Col, Button } from 'react-bootstrap';\r\n// import Button from '@material-ui/core/Button';\r\nimport { MDBCardImage} from \"mdbreact\";\r\n\r\n\r\nclass Showtimes extends React.Component {\r\n\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            cinema: this.props.location.state.cinema,\r\n            movie_id: this.props.location.state.movie_id,\r\n            result: [],\r\n            cinema_id: '',\r\n            city_id: '',\r\n            apikeyIS: '5ogMBOJo2nty7v7YNku1eZkxHEAdEJMK',\r\n            apikeyOMDB: '9e790f8b',\r\n            imdbid: '',\r\n            movie_details: {},\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getData();\r\n\r\n    }\r\n\r\n    handleChange(event) {\r\n\r\n        const target = event.target;\r\n        const value = target.value;\r\n\r\n        // this.setState({\r\n        //     value : value,\r\n        //     redirect: true,\r\n        //   });\r\n\r\n        this.setState({\r\n            destination_value: this.state.cinema_arr[value],\r\n            redirect: true,\r\n        });\r\n        // console.log(this.state);\r\n        // console.log(this.state.value.location);\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n\r\n        // this.displayShowtimes()\r\n        const result = this.state.result;\r\n\r\n        const bold = {\r\n            fontWeight: 'bold',\r\n          };\r\n\r\n          const center = {\r\n            textAlign: 'center',\r\n          };\r\n\r\n\r\n\r\n\r\n        console.log(result);\r\n        return (\r\n            <div id=\"showtime\">\r\n\r\n\r\n                <Jumbotron fluid>\r\n\r\n                    <Container>\r\n                        <Row>\r\n                            <Col>   \r\n                            \r\n                            \r\n                            <MDBCardImage\r\n                                className=\"img-fluid pb-3 float-left\"\r\n                                src={this.state.movie_details.Poster}\r\n                            /> \r\n                            \r\n                            </Col>\r\n                            <Col xs={7}>  \r\n                            \r\n                            <h1>{this.state.movie_details.Title}</h1>\r\n\r\n                            <p><span style ={bold}>Release date:</span>  {this.state.movie_details.Released}  </p>\r\n                            <p> <span style ={bold}>IMDB Rating:</span>  {this.state.movie_details.imdbRating} </p>\r\n                            <p> <span style ={bold}>Runtime:</span>  {this.state.movie_details.Runtime} </p>\r\n                            <p> <span style ={bold}>Rated:</span>  {this.state.movie_details.Rated} </p>\r\n                            <p> <span style ={bold}>Genre:</span>  {this.state.movie_details.Genre} </p>\r\n                            <p> <span style ={bold}>Director:</span>  {this.state.movie_details.Director} </p>\r\n                            <p> <span style ={bold}>Production:</span>  {this.state.movie_details.Production} </p>\r\n                            <p> <span style ={bold}>Language:</span>  {this.state.movie_details.Language} </p>\r\n                    \r\n                            <p><span style ={bold}>Plot:</span> {this.state.movie_details.Plot}</p>\r\n                        \r\n                        \r\n                        </Col>\r\n\r\n\r\n                        </Row>\r\n\r\n\r\n                    </Container>\r\n                </Jumbotron>\r\n\r\n                <div className=\"table1\">\r\n                    <h3>{this.state.movie_details.Title} showtimes at {this.state.cinema} </h3>\r\n                    <br></br>\r\n                    <Table striped bordered hover variant=\"dark\"  >\r\n                        <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Timeslot</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {this.state.result.map((value, index) => (\r\n                                <tr>\r\n                                    <td>\r\n                                        {index + 1}\r\n                                    </td>\r\n                                    <td colSpan=\"2\">{value.start_at}</td>\r\n                                    <td style={center}><Button variant=\"outline-light\" value= {value.booking_link} onClick={this.handleChange}>Book Now</Button></td>\r\n                                </tr>\r\n                            ))}\r\n\r\n                        </tbody>\r\n                    </Table>\r\n                </div>\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n            // this.displayShowtimes()\r\n\r\n        )\r\n\r\n\r\n        // this.displayShowtimes()\r\n    }\r\n\r\n\r\n\r\n    getData() {\r\n        var xhr = new XMLHttpRequest()\r\n        var cinema_name = this.state.cinema;\r\n        let urlCinemas = \"https://api.internationalshowtimes.com/v4/cinemas/?apikey=\" + this.state.apikeyIS;\r\n        var movie_id = this.state.movie_id;\r\n        xhr.addEventListener('load', () => {\r\n            // update the state of the component with the result here\r\n            var resp = JSON.parse(xhr.responseText);\r\n            for (let i = 0; i < resp.cinemas.length; i++) {\r\n                var cinema = resp.cinemas[i];\r\n                if (cinema_name.toLowerCase() == cinema.name.toLowerCase()) {\r\n                    this.setState({\r\n                        cinema_id: cinema.id,\r\n                        city_id: cinema.city_id,\r\n                    });\r\n                }\r\n\r\n            }\r\n\r\n            console.log(this.state);\r\n\r\n            var xhr2 = new XMLHttpRequest()\r\n            var city_id = this.state.city_id;\r\n\r\n\r\n            console.log(city_id)\r\n            console.log(movie_id)\r\n\r\n            //get showtimes\r\n            let urlShowtimes = \"https://api.internationalshowtimes.com/v4/showtimes?city_ids=\" + city_id + \"&movie_id=\" + movie_id + \"&apikey=\" + this.state.apikeyIS;\r\n            xhr2.addEventListener('load', () => {\r\n                // update the state of the component with the result here\r\n                var result_arr = [];\r\n                var resp = JSON.parse(xhr2.responseText);\r\n                console.log(this.state.cinema_id)\r\n                console.log(movie_id)\r\n                for (let i = 0; i < resp.showtimes.length; i++) {\r\n                    var showtime = resp.showtimes[i];\r\n                    // console.log(showtime);\r\n                    if (showtime.cinema_id == this.state.cinema_id && showtime.movie_id == movie_id) {\r\n                        result_arr.push(showtime);\r\n                    }\r\n\r\n\r\n                }\r\n\r\n                console.log(result_arr);\r\n\r\n                this.setState({\r\n                    result: result_arr,\r\n                });\r\n\r\n            })\r\n            xhr2.open('GET', urlShowtimes)\r\n            xhr2.send()\r\n\r\n            console.log(this.state);\r\n\r\n\r\n\r\n        })\r\n        xhr.open('GET', urlCinemas)\r\n        xhr.send()\r\n\r\n\r\n\r\n\r\n\r\n        // get movie details\r\n        var xhr3 = new XMLHttpRequest();\r\n        let urlmoviedetails = \"https://api.internationalshowtimes.com/v4/movies/\" + movie_id + \"?fields=imdb_id&apikey=\" + this.state.apikeyIS;\r\n\r\n        xhr3.addEventListener('load', () => {\r\n            // update the state of the component with the result here\r\n            var resp = JSON.parse(xhr3.responseText);\r\n            this.setState({\r\n                imdbid: resp.movie.imdb_id,\r\n            });\r\n\r\n            console.log(this.state.imdbid);\r\n\r\n            var xhr4 = new XMLHttpRequest()\r\n\r\n            //get movie details from imdb\r\n            let urlMovieDetails = \"http://www.omdbapi.com/?i=\" + this.state.imdbid + \"&apikey=\" + this.state.apikeyOMDB;\r\n            xhr4.addEventListener('load', () => {\r\n                // update the state of the component with the result here\r\n\r\n\r\n                var resp = JSON.parse(xhr4.responseText);\r\n                this.setState({\r\n                    movie_details: resp,\r\n                });\r\n\r\n                console.log(this.state);\r\n            })\r\n            xhr4.open('GET', urlMovieDetails)\r\n            xhr4.send()\r\n\r\n\r\n\r\n\r\n\r\n        })\r\n        xhr3.open('GET', urlmoviedetails)\r\n        xhr3.send()\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n    displayShowtimes() {\r\n\r\n        // this.getData();\r\n        let r = this.state.result;\r\n        var test = '';\r\n        var result = \"<table> <tr> <th>S/No</th> <th>Time</th></tr>\";\r\n        console.log(r);\r\n        for (let i = 0; i < r.length; i++) {\r\n            result += \"<tr><td>\" + (i + 1) + \"</td><td>\" + r[i].start_at + \"</td></tr>\";\r\n            test += (i + 1) + \" \" + r[i].start_at + \" \";\r\n        }\r\n        result += \"</table>\";\r\n\r\n        // return \"<div id  = 'showtime' dangerouslySetInnerHTML={{__html:\"+result+'}}></div>'\r\n\r\n        return result;\r\n\r\n        // this.document.getElementById(\"showtime\").innerHTML = result;\r\n    }\r\n}\r\n\r\nexport default Showtimes;"]},"metadata":{},"sourceType":"module"}