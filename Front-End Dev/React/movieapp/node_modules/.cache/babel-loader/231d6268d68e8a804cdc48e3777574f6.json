{"ast":null,"code":"var _jsxFileName = \"/Users/syukrirahiman/OneDrive - Singapore Management University/React/movieapp/src/Maps.js\";\nimport React, { Component } from 'react';\nimport './Maps.css';\nimport axios from 'axios';\n\nclass Maps extends Component {\n  constructor(props) {\n    super(props);\n\n    this.renderMap = () => {\n      loadScript(\"https://maps.googleapis.com/maps/api/js?key=\" + this.state.apikey + \"&callback=initMap\");\n      window.initMap = this.initMap;\n    };\n\n    this.initMap = () => {\n      var location = this.state.destination; // Create A Map\n\n      var directionsRenderer = new window.google.maps.DirectionsRenderer({\n        draggable: true\n      });\n      var directionsService = new window.google.maps.DirectionsService();\n      var map = new window.google.maps.Map(document.getElementById('map'), {\n        center: {\n          lat: -34.397,\n          lng: 150.644\n        },\n        zoom: 15,\n        center: location\n      });\n      directionsRenderer.setMap(map);\n      directionsRenderer.setPanel(document.getElementById('right-panel'));\n      var control = document.getElementById('floating-panel');\n      control.style.display = 'block';\n      map.controls[window.google.maps.ControlPosition.TOP_CENTER].push(control);\n      var marker = new window.google.maps.Marker({\n        position: location,\n        map: map,\n        title: 'Cinema Here!'\n      }); // GET CARPARKS NEARBY (PLACES API)\n\n      var loc_lat = location.lat;\n      var loc_lng = location.lng;\n      var places_loc = loc_lat + \" \" + loc_lng;\n      var baseurl = \"https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=\" + places_loc + \"&radius=1000&type=parking&key=\" + this.state.apikey;\n      var request = new XMLHttpRequest();\n      request.open('GET', baseurl, true);\n\n      request.onload = function () {\n        var data = JSON.parse(this.response);\n        var cp_array = data.results;\n\n        for (var cp of cp_array) {\n          var lat = cp.geometry.location.lat;\n          var lng = cp.geometry.location.lng;\n          marker = new window.google.maps.Marker({\n            position: {\n              lat: lat,\n              lng: lng\n            },\n            map: map,\n            icon: {\n              url: \"https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png\"\n            },\n            title: \"\".concat(cp.name)\n          }); // PARTS BELOW WERE PREVIOUSLY USED TO ATTEMPT TO GET A MATCH FROM DIFFERENT APIS\n          // lat = lat + \" \";\n          // lng = lng + \" \";\n          // lat = lat.slice(0,4);\n          // lng = lng.slice(0,6);\n          // var latlng = lat + \" \" + lng;\n          // var address = cp.name;\n          // var cp_position = lat + \" \" + lng;\n          // DISPLAY CARPARKS IN DROPDOWN LIST\n          // document.getElementById(\"cp_choices\").innerHTML += `<option value=\"${latlng}\">${address}</option>`\n        }\n      };\n\n      request.send();\n\n      var onChangeHandler = () => {\n        this.calculateAndDisplayRoute(directionsService, directionsRenderer);\n      }; // WHEN SUBMIT BUTTON IS CLICK, RENDERS DIRECTION SERVICE\n\n\n      document.getElementById('submit').addEventListener('click', onChangeHandler);\n    };\n\n    this.state = {\n      destination_value: this.props.location.state.destination_value,\n      destination: {\n        lat: this.props.location.state.destination_value.lat,\n        lng: this.props.location.state.destination_value.lon\n      },\n      apikey: 'AIzaSyCZaEKchtQMFyZCWlTIiXcwySwsR0WhTLY',\n      curr_loc: ''\n    };\n    this.showPosition = this.showPosition.bind(this);\n  }\n\n  componentDidMount() {\n    // this.getVenues()\n    this.renderMap();\n\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(this.showPosition);\n    }\n  }\n\n  mDisplay() {\n    document.getElementById(\"map\").style.marginRight = \"400px\";\n    document.getElementById(\"right-panel\").style.height = \"100vh\";\n  }\n\n  showPosition(position) {\n    var lat = position.coords.latitude;\n    var lng = position.coords.longitude;\n    console.log(lat);\n    console.log(lng);\n    var xhr = new XMLHttpRequest();\n    var url = \"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + lat + \",\" + lng + \"&key=\" + this.state.apikey;\n    xhr.addEventListener('load', () => {\n      var resp = JSON.parse(xhr.responseText);\n      console.log(resp);\n      var address = resp.results[0].address_components[0].long_name + \" \" + resp.results[0].address_components[1].long_name;\n      this.setState({\n        curr_loc: address\n      });\n    });\n    xhr.open('GET', url);\n    xhr.send();\n  }\n\n  calculateAndDisplayRoute(directionsService, directionsRenderer) {\n    console.log(\"here\");\n    var start = document.getElementById('start').value;\n    var mode = document.getElementById('mode').value; // INSERT CINEMA LOCATION HERE AGAIN\n\n    var end = this.state.destination;\n    directionsService.route({\n      origin: start,\n      destination: end,\n      travelMode: mode\n    }, function (response, status) {\n      if (status === 'OK') {\n        directionsRenderer.setDirections(response);\n      } else {\n        window.alert('Directions request failed due to ' + status);\n      }\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        height: \"auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"floating-panel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, \"Start:\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"start\",\n      id: \"start\",\n      defaultValue: this.state.curr_loc,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }), React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"Mode of Travel: \"), React.createElement(\"select\", {\n      id: \"mode\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"DRIVING\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, \"Driving\"), React.createElement(\"option\", {\n      value: \"WALKING\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"Walking\"), React.createElement(\"option\", {\n      value: \"BICYCLING\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"Bicycling\"), React.createElement(\"option\", {\n      value: \"TRANSIT\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"Transit\")), React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.mDisplay,\n      className: \"btn btn-light\",\n      id: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, \"GO\")), React.createElement(\"div\", {\n      id: \"right-panel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"map\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"availability\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }));\n  }\n\n}\n\nfunction loadScript(url) {\n  var index = window.document.getElementsByTagName(\"script\")[0];\n  var script = window.document.createElement(\"script\");\n  script.src = url;\n  script.async = true;\n  script.defer = true;\n  index.parentNode.insertBefore(script, index);\n}\n\nexport default Maps;","map":{"version":3,"sources":["/Users/syukrirahiman/OneDrive - Singapore Management University/React/movieapp/src/Maps.js"],"names":["React","Component","axios","Maps","constructor","props","renderMap","loadScript","state","apikey","window","initMap","location","destination","directionsRenderer","google","maps","DirectionsRenderer","draggable","directionsService","DirectionsService","map","Map","document","getElementById","center","lat","lng","zoom","setMap","setPanel","control","style","display","controls","ControlPosition","TOP_CENTER","push","marker","Marker","position","title","loc_lat","loc_lng","places_loc","baseurl","request","XMLHttpRequest","open","onload","data","JSON","parse","response","cp_array","results","cp","geometry","icon","url","name","send","onChangeHandler","calculateAndDisplayRoute","addEventListener","destination_value","lon","curr_loc","showPosition","bind","componentDidMount","navigator","geolocation","getCurrentPosition","mDisplay","marginRight","height","coords","latitude","longitude","console","log","xhr","resp","responseText","address","address_components","long_name","setState","start","value","mode","end","route","origin","travelMode","status","setDirections","alert","render","index","getElementsByTagName","script","createElement","src","async","defer","parentNode","insertBefore"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport './Maps.css'\n\nimport axios from 'axios'\n\nclass Maps extends Component {\n\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      destination_value: this.props.location.state.destination_value,\n      destination: { lat: this.props.location.state.destination_value.lat, lng: this.props.location.state.destination_value.lon },\n      apikey: 'AIzaSyCZaEKchtQMFyZCWlTIiXcwySwsR0WhTLY',\n      curr_loc: '',\n    };\n    this.showPosition = this.showPosition.bind(this);\n\n}\n\n  componentDidMount() {\n    // this.getVenues()\n    this.renderMap()\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(this.showPosition);\n  } \n  }\n\n  mDisplay() {\n    document.getElementById(\"map\").style.marginRight = \"400px\";\n    document.getElementById(\"right-panel\").style.height = \"100vh\";\n  }\n  showPosition(position) {\n    var lat = position.coords.latitude;\n    var lng = position.coords.longitude;\n\n    console.log(lat)\n    console.log(lng)\n\n    var xhr = new XMLHttpRequest();\n\n\n    var url = \"https://maps.googleapis.com/maps/api/geocode/json?latlng=\"+lat+\",\"+lng+\"&key=\"+this.state.apikey;\n    xhr.addEventListener('load', () => {\n      var resp = JSON.parse(xhr.responseText);\n      console.log(resp)\n      var address = resp.results[0].address_components[0].long_name + \" \" + resp.results[0].address_components[1].long_name\n      this.setState({\n          curr_loc: address,\n      });\n  })\n\n  xhr.open('GET', url);\n  xhr.send();\n\n}\n\n  renderMap = () => {\n    loadScript(\"https://maps.googleapis.com/maps/api/js?key=\"+this.state.apikey+\"&callback=initMap\")\n    window.initMap = this.initMap\n  }\n\n \n\n  initMap = () => {\n    var location = this.state.destination;\n    // Create A Map\n    var directionsRenderer = new window.google.maps.DirectionsRenderer({ draggable: true });\n    var directionsService = new window.google.maps.DirectionsService;\n    var map = new window.google.maps.Map(document.getElementById('map'), {\n      center: { lat: -34.397, lng: 150.644 },\n      zoom: 15,\n      center: location\n    })\n    directionsRenderer.setMap(map);\n    directionsRenderer.setPanel(document.getElementById('right-panel'));\n\n    var control = document.getElementById('floating-panel');\n    control.style.display = 'block';\n    map.controls[window.google.maps.ControlPosition.TOP_CENTER].push(control);\n\n    var marker = new window.google.maps.Marker({\n      position: location,\n      map: map,\n      title: 'Cinema Here!'\n    });\n\n    // GET CARPARKS NEARBY (PLACES API)\n    var loc_lat = location.lat;\n    var loc_lng = location.lng;\n    var places_loc = loc_lat + \" \" + loc_lng;\n    var baseurl = \"https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=\"+places_loc+\"&radius=1000&type=parking&key=\"+this.state.apikey;\n    var request = new XMLHttpRequest();\n    request.open('GET', baseurl, true)\n    request.onload = function () {\n      var data = JSON.parse(this.response)\n      var cp_array = data.results;\n      for (var cp of cp_array) {\n        var lat = cp.geometry.location.lat;\n        var lng = cp.geometry.location.lng;\n        marker = new window.google.maps.Marker({\n          position: { lat: lat, lng: lng },\n          map: map,\n          icon: {\n            url: \"https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png\"\n          },\n          title: `${cp.name}`\n        });\n\n        // PARTS BELOW WERE PREVIOUSLY USED TO ATTEMPT TO GET A MATCH FROM DIFFERENT APIS\n        // lat = lat + \" \";\n        // lng = lng + \" \";\n        // lat = lat.slice(0,4);\n        // lng = lng.slice(0,6);\n        // var latlng = lat + \" \" + lng;\n        // var address = cp.name;\n        // var cp_position = lat + \" \" + lng;\n\n        // DISPLAY CARPARKS IN DROPDOWN LIST\n        // document.getElementById(\"cp_choices\").innerHTML += `<option value=\"${latlng}\">${address}</option>`\n\n      }\n    }\n\n    request.send()\n\n    var onChangeHandler =  () => {\n      this.calculateAndDisplayRoute(directionsService, directionsRenderer);\n    };\n\n    // WHEN SUBMIT BUTTON IS CLICK, RENDERS DIRECTION SERVICE\n    document.getElementById('submit').addEventListener('click', onChangeHandler);\n\n\n  }\n\n  calculateAndDisplayRoute (directionsService, directionsRenderer) {\n    console.log(\"here\")\n    var start = document.getElementById('start').value;\n    var mode = document.getElementById('mode').value;\n  \n  \n    // INSERT CINEMA LOCATION HERE AGAIN\n    var end = this.state.destination;\n  \n  \n    directionsService.route({\n      origin: start,\n      destination: end,\n      travelMode: mode\n    }, function (response, status) {\n      if (status === 'OK') {\n        directionsRenderer.setDirections(response);\n      } else {\n        window.alert('Directions request failed due to ' + status);\n      }\n    });\n    \n  }\n \n\n\n  render() {\n    return (\n      <div style = {{height:\"auto\"}}>\n        <div id=\"floating-panel\">\n          <strong>Start:</strong>\n          <input type=\"text\" name=\"start\" id=\"start\" defaultValue ={this.state.curr_loc}/>\n          <br />\n          <strong>Mode of Travel: </strong>\n          <select id=\"mode\">\n            <option value=\"DRIVING\">Driving</option>\n            <option value=\"WALKING\">Walking</option>\n            <option value=\"BICYCLING\">Bicycling</option>\n            <option value=\"TRANSIT\">Transit</option>\n          </select>\n          <button type=\"button\" onClick={this.mDisplay} className=\"btn btn-light\" id=\"submit\">GO</button>\n\n        </div>\n        <div id=\"right-panel\"></div>\n        <div id=\"map\"></div>\n\n        <div id=\"availability\"></div>\n\n      </div>\n    )\n  }\n}\n\nfunction loadScript(url) {\n  var index = window.document.getElementsByTagName(\"script\")[0]\n  var script = window.document.createElement(\"script\")\n  script.src = url\n  script.async = true\n  script.defer = true\n  index.parentNode.insertBefore(script, index)\n}\n\n\n\nexport default Maps;"]},"metadata":{},"sourceType":"module"}