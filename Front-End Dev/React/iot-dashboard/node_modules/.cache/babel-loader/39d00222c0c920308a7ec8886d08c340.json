{"ast":null,"code":"import _classCallCheck from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import'firebase/database';import*as firebase from'firebase/app';import{Table,Jumbotron,Container,Row,Col,Button,Pagination}from'react-bootstrap';var beaconlist={\"c2af522362be\":\"Client A\",\"e20200bc8540\":\"Client B\"};var imagelist={\"c2af522362be\":require(\".././img/clienta.png\"),\"e20200bc8540\":require(\".././img/clienta.png\")};var TableDashboardSystem=/*#__PURE__*/function(_React$Component){_inherits(TableDashboardSystem,_React$Component);function TableDashboardSystem(props){var _this;_classCallCheck(this,TableDashboardSystem);_this=_possibleConstructorReturn(this,_getPrototypeOf(TableDashboardSystem).call(this,props));var beaconlist={\"c2af522362be\":\"Client A\",\"e20200bc8540\":\"Client B\"};var self=_assertThisInitialized(_this);var rootRef=firebase.database().ref();var beaconRef=rootRef.child('deployment').orderByChild(\"dateAdded\");//sort by timestamp\nvar tableval=beaconRef.limitToLast(1).on('child_added',function(snapshot){var data=snapshot.val();console.log(data);console.log(beaconlist[0]);var beacon_1=data[Object.keys(beaconlist)[0]];var beacon_2=data[Object.keys(beaconlist)[1]];var dateAddedString=data.dateAdded;console.log(beacon_1);self.setState({beaconArray:[{id:beacon_1.id,lastSeen:beacon_1.lastSeen,rssi_da1:beacon_1.rssi_da1,lastSeen_da1:beacon_1.lastSeen_da1,rssi_ma1:beacon_1.rssi_ma1,last_seen_ma1:beacon_1.last_seen_ma1,rssi_r1:beacon_1.rssi_r1,last_seen_r1:beacon_1.last_seen_r1,statusMsg:beacon_1.statusMsg},{id:beacon_2.id,lastSeen:beacon_2.lastSeen,rssi_da1:beacon_2.rssi_da1,lastSeen_da1:beacon_2.lastSeen_da1,rssi_ma1:beacon_2.rssi_ma1,last_seen_ma1:beacon_2.last_seen_ma1,rssi_r1:beacon_2.rssi_r1,last_seen_r1:beacon_2.last_seen_r1,statusMsg:beacon_2.statusMsg}],dateAddedString:dateAddedString});});_this.state={beaconArray:[]};return _this;}_createClass(TableDashboardSystem,[{key:\"renderTableHeader\",value:function renderTableHeader(){var header=Object.keys(this.state.beaconArray);return header.map(function(key,index){return React.createElement(\"th\",{key:index},key.toUpperCase());});}},{key:\"renderTableData\",value:function renderTableData(){var beaconArray=this.state.beaconArray;console.log(beaconArray);var latest_da1=JSON.parse(beaconArray[0].lastSeen_da1);var latest_ma1=JSON.parse(beaconArray[0].last_seen_ma1);var latest_r1=JSON.parse(beaconArray[0].last_seen_r1);var dateAddedString=JSON.parse(this.state.dateAddedString);for(var i=1;i<beaconArray.length;i++){var current_da1=JSON.parse(beaconArray[i].lastSeen_da1);var current_ma1=JSON.parse(beaconArray[i].last_seen_ma1);var current_r1=JSON.parse(beaconArray[i].last_seen_r1);if(new Date(current_da1)>new Date(latest_da1)){latest_da1=current_da1;}if(new Date(current_ma1)>new Date(latest_ma1)){latest_ma1=current_ma1;}if(new Date(current_r1)>new Date(latest_r1)){latest_r1=current_r1;}}return React.createElement(\"tbody\",null,React.createElement(\"tr\",null,React.createElement(\"td\",null,\"Gateway\"),React.createElement(\"td\",null,new Date(dateAddedString).toString().substring(0,25)),React.createElement(\"td\",null,this.diff_hours(new Date(dateAddedString))),React.createElement(\"td\",null,this.checkStatusGateway(new Date(dateAddedString)))),React.createElement(\"tr\",null,React.createElement(\"td\",null,\"Receiver 1\"),React.createElement(\"td\",null,new Date(latest_da1).toString().substring(0,25)),React.createElement(\"td\",null,this.diff_hours(new Date(latest_da1))),React.createElement(\"td\",null,this.checkStatusReceiver(new Date(latest_da1)))),React.createElement(\"tr\",null,React.createElement(\"td\",null,\"Receiver 2\"),React.createElement(\"td\",null,new Date(latest_r1).toString().substring(0,25)),React.createElement(\"td\",null,this.diff_hours(new Date(latest_r1))),React.createElement(\"td\",null,this.checkStatusReceiver(new Date(latest_r1)))),React.createElement(\"tr\",null,React.createElement(\"td\",null,\"Receiver 3\"),React.createElement(\"td\",null,new Date(latest_ma1).toString().substring(0,25)),React.createElement(\"td\",null,this.diff_hours(new Date(latest_ma1))),React.createElement(\"td\",null,this.checkStatusReceiver(new Date(latest_ma1)))));// <td>{new Date(latest_da1).toString().substring(0, 25)}</td>\n// <td>{new Date(latest_r1).toString().substring(0, 25)}</td>\n// <td>{new Date(latest_ma1).toString().substring(0, 25)}</td>\n}},{key:\"checkStatusReceiver\",value:function checkStatusReceiver(date){var current=new Date();// get total seconds between the times\nvar delta=Math.abs(current-date)/1000;// calculate (and subtract) whole days\nvar days=Math.floor(delta/86400);delta-=days*86400;// calculate (and subtract) whole hours\nvar hours=Math.floor(delta/3600)%24;delta-=hours*3600;// calculate (and subtract) whole minutes\nvar minutes=Math.floor(delta/60)%60;delta-=minutes*60;// what's left is seconds\nvar seconds=Math.round(delta%60);if(hours>11){return React.createElement(\"p\",null,\"Requires Maintenance\");}if(days>1){return React.createElement(\"p\",null,\"Requires Maintenance\");}return\"Device is working\";}},{key:\"checkStatusGateway\",value:function checkStatusGateway(date){var current=new Date();// get total seconds between the times\nvar delta=Math.abs(current-date)/1000;// calculate (and subtract) whole days\nvar days=Math.floor(delta/86400);delta-=days*86400;// calculate (and subtract) whole hours\nvar hours=Math.floor(delta/3600)%24;delta-=hours*3600;// calculate (and subtract) whole minutes\nvar minutes=Math.floor(delta/60)%60;delta-=minutes*60;// what's left is seconds\nvar seconds=Math.round(delta%60);if(minutes>1){return React.createElement(\"p\",null,\"Requires Maintenance\");}if(hours>1){return React.createElement(\"p\",null,\"Requires Maintenance\");}if(days>1){return React.createElement(\"p\",null,\"Requires Maintenance\");}return\"Device is working\";}},{key:\"renderTableData2\",value:function renderTableData2(){var beaconArray=this.state.beaconArray;console.log(beaconArray);var latest_da1=JSON.parse(beaconArray[0].lastSeen_da1);var latest_ma1=JSON.parse(beaconArray[0].last_seen_ma1);var latest_r1=JSON.parse(beaconArray[0].last_seen_r1);var dateAddedString=JSON.parse(this.state.dateAddedString);for(var i=1;i<beaconArray.length;i++){var current_da1=JSON.parse(beaconArray[i].lastSeen_da1);var current_ma1=JSON.parse(beaconArray[i].last_seen_ma1);var current_r1=JSON.parse(beaconArray[i].last_seen_r1);if(new Date(current_da1)>new Date(latest_da1)){latest_da1=current_da1;}if(new Date(current_ma1)>new Date(latest_ma1)){latest_ma1=current_ma1;}if(new Date(current_r1)>new Date(latest_r1)){latest_r1=current_r1;}}return React.createElement(\"tr\",null,React.createElement(\"td\",null,this.diff_hours(new Date(latest_da1))+\" hr(s)\"),React.createElement(\"td\",null,this.diff_hours(new Date(latest_r1))+\" hr(s)\"),React.createElement(\"td\",null,this.diff_hours(new Date(latest_ma1))+\" hr(s)\"),React.createElement(\"td\",null,this.diff_hours(new Date(dateAddedString))+\" hr(s)\"));}},{key:\"diff_hours\",value:function diff_hours(date){var current=new Date();// get total seconds between the times\nvar delta=Math.abs(current-date)/1000;// calculate (and subtract) whole days\nvar days=Math.floor(delta/86400);delta-=days*86400;// calculate (and subtract) whole hours\nvar hours=Math.floor(delta/3600)%24;delta-=hours*3600;// calculate (and subtract) whole minutes\nvar minutes=Math.floor(delta/60)%60;delta-=minutes*60;// what's left is seconds\nvar seconds=Math.round(delta%60);// in theory the modulus is not required\nreturn days+\" Day \"+hours+\" Hr \"+minutes+\" Min \"+seconds+\" Sec \";// var diff = (date.getTime() - current.getTime()) / 1000;\n// diff /= (60 * 60);\n// return Math.abs(Math.round(diff));\n}},{key:\"render\",value:function render(){if(this.state.beaconArray.length>0){return(/* font-size: calc(10px + 2vmin); */React.createElement(\"div\",{style:{marginTop:\"10px\",paddingBottom:\"20px\",fontSize:\"calc(10px + 2vmin)\"}},React.createElement(\"h1\",{id:\"title\",style:{color:\"white\",marginBottom:\"15px\"}},\"System Monitoring Dashboard\"),React.createElement(\"img\",{style:{width:\"700px\",height:\"400px\",marginLeft:\"10px\",backgroundColor:\"White\"},src:require(\".././img/layout.jpg\")}),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Latest Datetime Data Retrieved from Gateway: \",React.createElement(\"b\",{style:{color:\"OrangeRed\"}},new Date(JSON.parse(this.state.dateAddedString)).toString().substring(0,25))),React.createElement(\"hr\",{style:{color:\"white\",backgroundColor:\"white\",height:1}}),React.createElement(\"h3\",null,\"Device List\"),React.createElement(Table,{striped:true,bordered:true,hover:true,variant:\"dark\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Device\"),React.createElement(\"th\",null,\"Latest Data Timestamp\"),React.createElement(\"th\",null,\"Amount of Duration \",React.createElement(\"br\",null),\"Device has Stopped Sending Data\"),React.createElement(\"th\",null,\"Status\"))),this.renderTableData()),React.createElement(\"span\",{style:{fontSize:\"large\",fontStyle:\"italic\"}},\"If any of the devices' status is reflected as \\\"Requires Maintenance\\\", please ensure that the device is turned on. \",React.createElement(\"br\",null),\"Otherwise, please contact Bearcons' IT helpdesk for maintenance service. \")));}return React.createElement(\"div\",null);}}]);return TableDashboardSystem;}(React.Component);export default TableDashboardSystem;","map":{"version":3,"sources":["/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/src/components/Tables/tablesSystem.js"],"names":["React","Component","firebase","Table","Jumbotron","Container","Row","Col","Button","Pagination","beaconlist","imagelist","require","TableDashboardSystem","props","self","rootRef","database","ref","beaconRef","child","orderByChild","tableval","limitToLast","on","snapshot","data","val","console","log","beacon_1","Object","keys","beacon_2","dateAddedString","dateAdded","setState","beaconArray","id","lastSeen","rssi_da1","lastSeen_da1","rssi_ma1","last_seen_ma1","rssi_r1","last_seen_r1","statusMsg","state","header","map","key","index","toUpperCase","latest_da1","JSON","parse","latest_ma1","latest_r1","i","length","current_da1","current_ma1","current_r1","Date","toString","substring","diff_hours","checkStatusGateway","checkStatusReceiver","date","current","delta","Math","abs","days","floor","hours","minutes","seconds","round","marginTop","paddingBottom","fontSize","color","marginBottom","width","height","marginLeft","backgroundColor","renderTableData","fontStyle"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport 'firebase/database';\nimport * as firebase from 'firebase/app'\nimport { Table, Jumbotron, Container, Row, Col, Button, Pagination } from 'react-bootstrap';\n\nconst beaconlist = { \"c2af522362be\": \"Client A\", \"e20200bc8540\": \"Client B\" }\nconst imagelist = { \"c2af522362be\": require(\".././img/clienta.png\"), \"e20200bc8540\": require(\".././img/clienta.png\") }\nclass TableDashboardSystem extends React.Component {\n   constructor(props) {\n      super(props)\n      const beaconlist = { \"c2af522362be\": \"Client A\", \"e20200bc8540\": \"Client B\" }\n      var self = this;\n      const rootRef = firebase.database().ref();\n      const beaconRef = rootRef.child('deployment').orderByChild(\"dateAdded\");\n      //sort by timestamp\n      const tableval = beaconRef.limitToLast(1).on('child_added', function (snapshot) {\n         var data = snapshot.val();\n\n         console.log(data);\n         console.log(beaconlist[0]);\n         var beacon_1 = data[Object.keys(beaconlist)[0]];\n         var beacon_2 = data[Object.keys(beaconlist)[1]];\n         var dateAddedString = data.dateAdded;\n         console.log(beacon_1);\n\n\n         self.setState({\n            beaconArray: [\n               {\n                  id: beacon_1.id,\n                  lastSeen: beacon_1.lastSeen,\n                  rssi_da1: beacon_1.rssi_da1,\n                  lastSeen_da1: beacon_1.lastSeen_da1,\n                  rssi_ma1: beacon_1.rssi_ma1,\n                  last_seen_ma1: beacon_1.last_seen_ma1,\n                  rssi_r1: beacon_1.rssi_r1,\n                  last_seen_r1: beacon_1.last_seen_r1,\n                  statusMsg: beacon_1.statusMsg,\n               },\n\n               {\n                  id: beacon_2.id,\n                  lastSeen: beacon_2.lastSeen,\n                  rssi_da1: beacon_2.rssi_da1,\n                  lastSeen_da1: beacon_2.lastSeen_da1,\n                  rssi_ma1: beacon_2.rssi_ma1,\n                  last_seen_ma1: beacon_2.last_seen_ma1,\n                  rssi_r1: beacon_2.rssi_r1,\n                  last_seen_r1: beacon_2.last_seen_r1,\n                  statusMsg: beacon_2.statusMsg\n               }\n\n            ],\n            dateAddedString: dateAddedString,\n\n         })\n\n      });\n\n      this.state = {\n         beaconArray: []\n      }\n   }\n\n\n   renderTableHeader() {\n\n      let header = Object.keys(this.state.beaconArray)\n      return header.map((key, index) => {\n         return <th key={index}>{key.toUpperCase()}</th>\n      })\n   }\n\n   renderTableData() {\n      var beaconArray = this.state.beaconArray;\n      console.log(beaconArray)\n\n      var latest_da1 = JSON.parse(beaconArray[0].lastSeen_da1);\n      var latest_ma1 = JSON.parse(beaconArray[0].last_seen_ma1);\n      var latest_r1 = JSON.parse(beaconArray[0].last_seen_r1);\n      var dateAddedString = JSON.parse(this.state.dateAddedString);\n\n      for (let i = 1; i < beaconArray.length; i++) {\n\n         var current_da1 = JSON.parse(beaconArray[i].lastSeen_da1);\n         var current_ma1 = JSON.parse(beaconArray[i].last_seen_ma1);\n         var current_r1 = JSON.parse(beaconArray[i].last_seen_r1);\n\n\n         if (new Date(current_da1) > new Date(latest_da1)) {\n            latest_da1 = current_da1\n         }\n\n         if (new Date(current_ma1) > new Date(latest_ma1)) {\n            latest_ma1 = current_ma1\n         }\n\n         if (new Date(current_r1) > new Date(latest_r1)) {\n            latest_r1 = current_r1\n         }\n\n      }\n\n      return (\n\n         <tbody>\n\n            <tr>\n               <td>Gateway</td>\n               <td>{new Date(dateAddedString).toString().substring(0, 25)}</td>\n               <td>{this.diff_hours(new Date(dateAddedString))}</td>\n               <td>{this.checkStatusGateway(new Date(dateAddedString))}</td>\n            </tr>\n\n            <tr>\n               <td>Receiver 1</td>\n               <td>{new Date(latest_da1).toString().substring(0, 25)}</td>\n               <td>{this.diff_hours(new Date(latest_da1))}</td>\n               <td>{this.checkStatusReceiver(new Date(latest_da1))}</td>\n\n            </tr>\n\n            <tr>\n               <td>Receiver 2</td>\n               <td>{new Date(latest_r1).toString().substring(0, 25)}</td>\n               <td>{this.diff_hours(new Date(latest_r1))}</td>\n               <td>{this.checkStatusReceiver(new Date(latest_r1))}</td>\n\n            </tr>\n\n            <tr>\n               <td>Receiver 3</td>\n               <td>{new Date(latest_ma1).toString().substring(0, 25)}</td>\n               <td>{this.diff_hours(new Date(latest_ma1))}</td>\n               <td>{this.checkStatusReceiver(new Date(latest_ma1))}</td>\n\n            </tr>\n         </tbody>\n      )\n\n      // <td>{new Date(latest_da1).toString().substring(0, 25)}</td>\n      // <td>{new Date(latest_r1).toString().substring(0, 25)}</td>\n      // <td>{new Date(latest_ma1).toString().substring(0, 25)}</td>\n\n\n   }\n\n   checkStatusReceiver(date){\n      var current = new Date()\n\n      // get total seconds between the times\n      var delta = Math.abs(current - date) / 1000;\n\n      // calculate (and subtract) whole days\n      var days = Math.floor(delta / 86400);\n      delta -= days * 86400;\n\n      // calculate (and subtract) whole hours\n      var hours = Math.floor(delta / 3600) % 24;\n      delta -= hours * 3600;\n\n      // calculate (and subtract) whole minutes\n      var minutes = Math.floor(delta / 60) % 60;\n      delta -= minutes * 60;\n\n      // what's left is seconds\n      var seconds = Math.round(delta % 60);\n\n      if (hours > 11) {\n         return (<p>Requires Maintenance</p>)\n      }\n\n      if (days > 1) {\n         return (<p>Requires Maintenance</p>)\n      }\n\n      return \"Device is working\"\n\n   }\n\n   checkStatusGateway(date) {\n\n      var current = new Date()\n\n      // get total seconds between the times\n      var delta = Math.abs(current - date) / 1000;\n\n      // calculate (and subtract) whole days\n      var days = Math.floor(delta / 86400);\n      delta -= days * 86400;\n\n      // calculate (and subtract) whole hours\n      var hours = Math.floor(delta / 3600) % 24;\n      delta -= hours * 3600;\n\n      // calculate (and subtract) whole minutes\n      var minutes = Math.floor(delta / 60) % 60;\n      delta -= minutes * 60;\n\n      // what's left is seconds\n      var seconds = Math.round(delta % 60);\n\n      if (minutes > 1) {\n         return (<p>Requires Maintenance</p>)\n      }\n\n      if (hours > 1) {\n         return (<p>Requires Maintenance</p>)\n      }\n\n      if (days > 1) {\n         return (<p>Requires Maintenance</p>)\n      }\n\n      return \"Device is working\"\n   }\n\n   renderTableData2() {\n      var beaconArray = this.state.beaconArray;\n      console.log(beaconArray)\n\n      var latest_da1 = JSON.parse(beaconArray[0].lastSeen_da1);\n      var latest_ma1 = JSON.parse(beaconArray[0].last_seen_ma1);\n      var latest_r1 = JSON.parse(beaconArray[0].last_seen_r1);\n      var dateAddedString = JSON.parse(this.state.dateAddedString);\n\n      for (let i = 1; i < beaconArray.length; i++) {\n\n         var current_da1 = JSON.parse(beaconArray[i].lastSeen_da1);\n         var current_ma1 = JSON.parse(beaconArray[i].last_seen_ma1);\n         var current_r1 = JSON.parse(beaconArray[i].last_seen_r1);\n\n\n         if (new Date(current_da1) > new Date(latest_da1)) {\n            latest_da1 = current_da1\n         }\n\n         if (new Date(current_ma1) > new Date(latest_ma1)) {\n            latest_ma1 = current_ma1\n         }\n\n         if (new Date(current_r1) > new Date(latest_r1)) {\n            latest_r1 = current_r1\n         }\n\n      }\n\n      return (\n         <tr>\n            <td>{this.diff_hours(new Date(latest_da1)) + \" hr(s)\"}</td>\n            <td>{this.diff_hours(new Date(latest_r1)) + \" hr(s)\"}</td>\n            <td>{this.diff_hours(new Date(latest_ma1)) + \" hr(s)\"}</td>\n            <td>{this.diff_hours(new Date(dateAddedString)) + \" hr(s)\"}</td>\n         </tr>\n      )\n\n\n   }\n\n   diff_hours(date) {\n\n      var current = new Date()\n\n      // get total seconds between the times\n      var delta = Math.abs(current - date) / 1000;\n\n      // calculate (and subtract) whole days\n      var days = Math.floor(delta / 86400);\n      delta -= days * 86400;\n\n      // calculate (and subtract) whole hours\n      var hours = Math.floor(delta / 3600) % 24;\n      delta -= hours * 3600;\n\n      // calculate (and subtract) whole minutes\n      var minutes = Math.floor(delta / 60) % 60;\n      delta -= minutes * 60;\n\n      // what's left is seconds\n      var seconds = Math.round(delta % 60);  // in theory the modulus is not required\n\n\n      return days + \" Day \" + hours + \" Hr \" + minutes + \" Min \" + seconds + \" Sec \"\n\n      // var diff = (date.getTime() - current.getTime()) / 1000;\n      // diff /= (60 * 60);\n      // return Math.abs(Math.round(diff));\n\n   }\n\n   render() {\n      if (this.state.beaconArray.length > 0) {\n\n\n         return (\n\n\n            /* font-size: calc(10px + 2vmin); */\n            <div style={{ marginTop: \"10px\", paddingBottom: \"20px\", fontSize: \"calc(10px + 2vmin)\" }}>\n               {/* <Container>\n                  <Row>\n                     <Col>\n                        <img style={{ width: \"190px\", height: \"190px\", marginRight: \"30px\", marginLeft: \"30px\" }} src={require(\".././img/BEARCONS.png\")} />\n   \n                     </Col>\n                  </Row>\n               </Container> */}\n\n               <h1 id='title' style={{ color: \"white\", marginBottom: \"15px\" }}>System Monitoring Dashboard</h1>\n               <img style={{ width: \"700px\", height: \"400px\", marginLeft: \"10px\", backgroundColor: \"White\" }} src={require(\".././img/layout.jpg\")} />\n               <br></br>\n               <p>Latest Datetime Data Retrieved from Gateway: <b style={{ color: \"OrangeRed\" }}>{new Date(JSON.parse(this.state.dateAddedString)).toString().substring(0, 25)}</b></p>\n               <hr\n                  style={{\n                     color: \"white\",\n                     backgroundColor: \"white\",\n                     height: 1\n                  }}\n               />\n\n\n\n               <h3>Device List</h3>\n               <Table striped bordered hover variant=\"dark\"  >\n\n                  <thead>\n                     {/* <tr>{this.renderTableHeader()}</tr> */}\n                     <tr>\n                        <th>Device</th>\n                        <th>Latest Data Timestamp</th>   \n                        <th>Amount of Duration <br></br>Device has Stopped Sending Data</th>\n                        <th>Status</th>\n\n                     </tr>\n                  </thead>\n\n                  {this.renderTableData()}\n\n\n               </Table>\n\n               <span style ={{fontSize : \"large\", fontStyle: \"italic\"}}>If any of the devices' status is reflected as \"Requires Maintenance\", please ensure that the device is turned on. <br></br>Otherwise, please contact Bearcons' IT helpdesk for maintenance service. </span>\n\n\n\n\n\n            </div>\n         )\n      }\n\n      return (\n         <div></div>\n      )\n   }\n\n}\n\nexport default TableDashboardSystem"]},"metadata":{},"sourceType":"module"}