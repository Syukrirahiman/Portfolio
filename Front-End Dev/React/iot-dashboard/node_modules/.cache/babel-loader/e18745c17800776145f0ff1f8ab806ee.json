{"ast":null,"code":"import _classCallCheck from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import'firebase/database';import*as firebase from'firebase/app';import{Table,Jumbotron,Container,Row,Col,Button,Pagination}from'react-bootstrap';var beaconlist={\"c2af522362be\":\"Client A\",\"e20200bc8540\":\"Client B\"};var imagelist={\"c2af522362be\":require(\".././img/clienta.png\"),\"e20200bc8540\":require(\".././img/clienta.png\")};var TableDashboardSystem=/*#__PURE__*/function(_React$Component){_inherits(TableDashboardSystem,_React$Component);function TableDashboardSystem(props){var _this;_classCallCheck(this,TableDashboardSystem);_this=_possibleConstructorReturn(this,_getPrototypeOf(TableDashboardSystem).call(this,props));var beaconlist={\"c2af522362be\":\"Client A\",\"e20200bc8540\":\"Client B\"};var self=_assertThisInitialized(_this);var rootRef=firebase.database().ref();var beaconRef=rootRef.child('deployment').orderByChild(\"dateAdded\");//sort by timestamp\nvar tableval=beaconRef.limitToLast(1).on('child_added',function(snapshot){var data=snapshot.val();console.log(data);console.log(beaconlist[0]);var beacon_1=data[Object.keys(beaconlist)[0]];var beacon_2=data[Object.keys(beaconlist)[1]];var dateAddedString=data.dateAdded;console.log(beacon_1);self.setState({beaconArray:[{id:beacon_1.id,lastSeen:beacon_1.lastSeen,rssi_da1:beacon_1.rssi_da1,lastSeen_da1:beacon_1.lastSeen_da1,rssi_ma1:beacon_1.rssi_ma1,last_seen_ma1:beacon_1.last_seen_ma1,rssi_r1:beacon_1.rssi_r1,last_seen_r1:beacon_1.last_seen_r1,statusMsg:beacon_1.statusMsg},{id:beacon_2.id,lastSeen:beacon_2.lastSeen,rssi_da1:beacon_2.rssi_da1,lastSeen_da1:beacon_2.lastSeen_da1,rssi_ma1:beacon_2.rssi_ma1,last_seen_ma1:beacon_2.last_seen_ma1,rssi_r1:beacon_2.rssi_r1,last_seen_r1:beacon_2.last_seen_r1,statusMsg:beacon_2.statusMsg}],dateAddedString:dateAddedString});});_this.state={beaconArray:[]};return _this;}_createClass(TableDashboardSystem,[{key:\"renderTableHeader\",value:function renderTableHeader(){var header=Object.keys(this.state.beaconArray);return header.map(function(key,index){return React.createElement(\"th\",{key:index},key.toUpperCase());});}},{key:\"renderTableData\",value:function renderTableData(){var beaconArray=this.state.beaconArray;console.log(beaconArray);var latest_da1=JSON.parse(beaconArray[0].lastSeen_da1);var latest_ma1=JSON.parse(beaconArray[0].last_seen_ma1);var latest_r1=JSON.parse(beaconArray[0].last_seen_r1);for(var i=1;i<beaconArray.length;i++){var current_da1=JSON.parse(beaconArray[i].lastSeen_da1);var current_ma1=JSON.parse(beaconArray[i].last_seen_ma1);var current_r1=JSON.parse(beaconArray[i].last_seen_r1);if(new Date(current_da1)>new Date(latest_da1)){latest_da1=current_da1;}if(new Date(current_ma1)>new Date(latest_ma1)){latest_ma1=current_ma1;}if(new Date(current_r1)>new Date(latest_r1)){latest_r1=current_r1;}}return React.createElement(\"tr\",null,React.createElement(\"td\",null,new Date(latest_da1).toString().substring(0,25)),React.createElement(\"td\",null,new Date(latest_r1).toString().substring(0,25)),React.createElement(\"td\",null,new Date(latest_ma1).toString().substring(0,25)));}},{key:\"renderTableData2\",value:function renderTableData2(){var beaconArray=this.state.beaconArray;console.log(beaconArray);var latest_da1=JSON.parse(beaconArray[0].lastSeen_da1);var latest_ma1=JSON.parse(beaconArray[0].last_seen_ma1);var latest_r1=JSON.parse(beaconArray[0].last_seen_r1);var dateAddedString=JSON.parse(this.state.dateAddedString);for(var i=1;i<beaconArray.length;i++){var current_da1=JSON.parse(beaconArray[i].lastSeen_da1);var current_ma1=JSON.parse(beaconArray[i].last_seen_ma1);var current_r1=JSON.parse(beaconArray[i].last_seen_r1);if(new Date(current_da1)>new Date(latest_da1)){latest_da1=current_da1;}if(new Date(current_ma1)>new Date(latest_ma1)){latest_ma1=current_ma1;}if(new Date(current_r1)>new Date(latest_r1)){latest_r1=current_r1;}}return React.createElement(\"tr\",null,React.createElement(\"td\",null,this.diff_hours(new Date(latest_da1))+\" hr(s)\"),React.createElement(\"td\",null,this.diff_hours(new Date(latest_r1))+\" hr(s)\"),React.createElement(\"td\",null,this.diff_hours(new Date(latest_ma1))+\" hr(s)\"),React.createElement(\"td\",null,this.diff_hours(new Date(dateAddedString))+\" hr(s)\"));}},{key:\"diff_hours\",value:function diff_hours(date){var current=new Date();var diff=(date.getTime()-current.getTime())/1000;diff/=60*60;return Math.abs(Math.round(diff));}},{key:\"render\",value:function render(){if(this.state.beaconArray.length>0){return(/* font-size: calc(10px + 2vmin); */React.createElement(\"div\",{style:{marginTop:\"10px\",paddingBottom:\"20px\",fontSize:\"calc(10px + 2vmin)\"}},React.createElement(\"h1\",{id:\"title\",style:{color:\"white\",marginBottom:\"15px\"}},\"System Monitoring Dashboard\"),React.createElement(\"img\",{style:{width:\"700px\",height:\"400px\",marginLeft:\"10px\",backgroundColor:\"White\"},src:require(\".././img/layout.jpg\")}),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Latest Datetime Data Retrieved from Gateway: \",React.createElement(\"b\",{style:{color:\"OrangeRed\"}},new Date(JSON.parse(this.state.dateAddedString)).toString().substring(0,25))),React.createElement(\"hr\",{style:{color:\"white\",backgroundColor:\"white\",height:1}}),React.createElement(\"h3\",null,\"Latest Datetime Data Retrieved from:\"),React.createElement(Table,{striped:true,bordered:true,hover:true,variant:\"dark\"},React.createElement(\"table\",{id:\"beacon\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Receiver 1\"),React.createElement(\"th\",null,\"Receiver 2\"),React.createElement(\"th\",null,\"Receiver 3\"))),React.createElement(\"tbody\",null,this.renderTableData()))),React.createElement(\"h3\",null,\"Amount of duration each device has stopped sending data:\"),React.createElement(Table,{striped:true,bordered:true,hover:true,variant:\"dark\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Receiver 1\"),React.createElement(\"th\",null,\"Receiver 2\"),React.createElement(\"th\",null,\"Receiver 3\"),React.createElement(\"th\",null,\"Gateway\"))),React.createElement(\"tbody\",null,this.renderTableData2()))));}return React.createElement(\"div\",null);}}]);return TableDashboardSystem;}(React.Component);export default TableDashboardSystem;","map":{"version":3,"sources":["/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/src/components/Tables/tablesSystem.js"],"names":["React","Component","firebase","Table","Jumbotron","Container","Row","Col","Button","Pagination","beaconlist","imagelist","require","TableDashboardSystem","props","self","rootRef","database","ref","beaconRef","child","orderByChild","tableval","limitToLast","on","snapshot","data","val","console","log","beacon_1","Object","keys","beacon_2","dateAddedString","dateAdded","setState","beaconArray","id","lastSeen","rssi_da1","lastSeen_da1","rssi_ma1","last_seen_ma1","rssi_r1","last_seen_r1","statusMsg","state","header","map","key","index","toUpperCase","latest_da1","JSON","parse","latest_ma1","latest_r1","i","length","current_da1","current_ma1","current_r1","Date","toString","substring","diff_hours","date","current","diff","getTime","Math","abs","round","marginTop","paddingBottom","fontSize","color","marginBottom","width","height","marginLeft","backgroundColor","renderTableData","renderTableData2"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport 'firebase/database';\nimport * as firebase from 'firebase/app'\nimport { Table, Jumbotron, Container, Row, Col, Button, Pagination } from 'react-bootstrap';\n\nconst beaconlist = { \"c2af522362be\": \"Client A\", \"e20200bc8540\": \"Client B\" }\nconst imagelist = { \"c2af522362be\": require(\".././img/clienta.png\"), \"e20200bc8540\": require(\".././img/clienta.png\") }\nclass TableDashboardSystem extends React.Component {\n   constructor(props) {\n      super(props)\n      const beaconlist = { \"c2af522362be\": \"Client A\", \"e20200bc8540\": \"Client B\" }\n      var self = this;\n      const rootRef = firebase.database().ref();\n      const beaconRef = rootRef.child('deployment').orderByChild(\"dateAdded\");\n      //sort by timestamp\n      const tableval = beaconRef.limitToLast(1).on('child_added', function (snapshot) {\n         var data = snapshot.val();\n\n         console.log(data);\n         console.log(beaconlist[0]);\n         var beacon_1 = data[Object.keys(beaconlist)[0]];\n         var beacon_2 = data[Object.keys(beaconlist)[1]];\n         var dateAddedString = data.dateAdded;\n         console.log(beacon_1);\n\n\n         self.setState({\n            beaconArray: [\n               {\n                  id: beacon_1.id,\n                  lastSeen: beacon_1.lastSeen,\n                  rssi_da1: beacon_1.rssi_da1,\n                  lastSeen_da1: beacon_1.lastSeen_da1,\n                  rssi_ma1: beacon_1.rssi_ma1,\n                  last_seen_ma1: beacon_1.last_seen_ma1,\n                  rssi_r1: beacon_1.rssi_r1,\n                  last_seen_r1: beacon_1.last_seen_r1,\n                  statusMsg: beacon_1.statusMsg,\n               },\n\n               {\n                  id: beacon_2.id,\n                  lastSeen: beacon_2.lastSeen,\n                  rssi_da1: beacon_2.rssi_da1,\n                  lastSeen_da1: beacon_2.lastSeen_da1,\n                  rssi_ma1: beacon_2.rssi_ma1,\n                  last_seen_ma1: beacon_2.last_seen_ma1,\n                  rssi_r1: beacon_2.rssi_r1,\n                  last_seen_r1: beacon_2.last_seen_r1,\n                  statusMsg: beacon_2.statusMsg\n               }\n\n            ],\n            dateAddedString: dateAddedString,\n\n         })\n\n      });\n\n      this.state = {\n         beaconArray: []\n      }\n   }\n\n\n   renderTableHeader() {\n\n      let header = Object.keys(this.state.beaconArray)\n      return header.map((key, index) => {\n         return <th key={index}>{key.toUpperCase()}</th>\n      })\n   }\n\n   renderTableData() {\n      var beaconArray = this.state.beaconArray;\n      console.log(beaconArray)\n\n      var latest_da1 = JSON.parse(beaconArray[0].lastSeen_da1);\n      var latest_ma1 = JSON.parse(beaconArray[0].last_seen_ma1);\n      var latest_r1 = JSON.parse(beaconArray[0].last_seen_r1);\n\n      for (let i = 1; i < beaconArray.length; i++) {\n\n         var current_da1 = JSON.parse(beaconArray[i].lastSeen_da1);\n         var current_ma1 = JSON.parse(beaconArray[i].last_seen_ma1);\n         var current_r1 = JSON.parse(beaconArray[i].last_seen_r1);\n\n\n         if (new Date(current_da1) > new Date(latest_da1)) {\n            latest_da1 = current_da1\n         }\n\n         if (new Date(current_ma1) > new Date(latest_ma1)) {\n            latest_ma1 = current_ma1\n         }\n\n         if (new Date(current_r1) > new Date(latest_r1)) {\n            latest_r1 = current_r1\n         }\n\n      }\n\n      return (\n         <tr>\n            <td>{new Date(latest_da1).toString().substring(0, 25)}</td>\n            <td>{new Date(latest_r1).toString().substring(0, 25)}</td>\n            <td>{new Date(latest_ma1).toString().substring(0, 25)}</td>\n         </tr>\n      )\n\n\n   }\n\n\n   renderTableData2() {\n      var beaconArray = this.state.beaconArray;\n      console.log(beaconArray)\n\n      var latest_da1 = JSON.parse(beaconArray[0].lastSeen_da1);\n      var latest_ma1 = JSON.parse(beaconArray[0].last_seen_ma1);\n      var latest_r1 = JSON.parse(beaconArray[0].last_seen_r1);\n      var dateAddedString = JSON.parse(this.state.dateAddedString);\n\n      for (let i = 1; i < beaconArray.length; i++) {\n\n         var current_da1 = JSON.parse(beaconArray[i].lastSeen_da1);\n         var current_ma1 = JSON.parse(beaconArray[i].last_seen_ma1);\n         var current_r1 = JSON.parse(beaconArray[i].last_seen_r1);\n\n\n         if (new Date(current_da1) > new Date(latest_da1)) {\n            latest_da1 = current_da1\n         }\n\n         if (new Date(current_ma1) > new Date(latest_ma1)) {\n            latest_ma1 = current_ma1\n         }\n\n         if (new Date(current_r1) > new Date(latest_r1)) {\n            latest_r1 = current_r1\n         }\n\n      }\n\n      return (\n         <tr>\n            <td>{this.diff_hours(new Date(latest_da1)) + \" hr(s)\"}</td>\n            <td>{this.diff_hours(new Date(latest_r1))+ \" hr(s)\"}</td>\n            <td>{this.diff_hours(new Date(latest_ma1)) + \" hr(s)\"}</td>\n            <td>{this.diff_hours(new Date(dateAddedString))+ \" hr(s)\"}</td>\n         </tr>\n      )\n\n\n   }\n\n   diff_hours(date) {\n\n      var current = new Date()\n\n      var diff = (date.getTime() - current.getTime()) / 1000;\n      diff /= (60 * 60);\n      return Math.abs(Math.round(diff));\n\n   }\n\n   render() {\n      if (this.state.beaconArray.length > 0) {\n\n\n         return (\n\n\n            /* font-size: calc(10px + 2vmin); */\n            <div style={{ marginTop: \"10px\", paddingBottom: \"20px\", fontSize: \"calc(10px + 2vmin)\" }}>\n               {/* <Container>\n                  <Row>\n                     <Col>\n                        <img style={{ width: \"190px\", height: \"190px\", marginRight: \"30px\", marginLeft: \"30px\" }} src={require(\".././img/BEARCONS.png\")} />\n   \n                     </Col>\n                  </Row>\n               </Container> */}\n\n               <h1 id='title' style={{ color: \"white\", marginBottom: \"15px\" }}>System Monitoring Dashboard</h1>\n               <img style={{ width: \"700px\", height: \"400px\", marginLeft: \"10px\", backgroundColor: \"White\" }} src={require(\".././img/layout.jpg\")} />\n               <br></br>\n               <p>Latest Datetime Data Retrieved from Gateway: <b style={{color:\"OrangeRed\"}}>{new Date(JSON.parse(this.state.dateAddedString)).toString().substring(0, 25)}</b></p>\n               <hr\n                    style={{\n                        color: \"white\",\n                        backgroundColor: \"white\",\n                        height: 1\n                    }}\n                />\n              \n\n\n               <h3>Latest Datetime Data Retrieved from:</h3>\n               <Table striped bordered hover variant=\"dark\"  >\n                  <table id='beacon'>\n                     <thead>\n                        {/* <tr>{this.renderTableHeader()}</tr> */}\n                        <tr>\n                           <th>Receiver 1</th>\n                           <th>Receiver 2</th>\n                           <th>Receiver 3</th>\n\n                        </tr>\n                     </thead>\n                     <tbody>\n                        {this.renderTableData()}\n                     </tbody>\n                  </table>\n               </Table>\n\n               <h3>Amount of duration each device has stopped sending data:</h3>\n               <Table striped bordered hover variant=\"dark\"  >\n             \n                     <thead>\n                        {/* <tr>{this.renderTableHeader()}</tr> */}\n                        <tr>\n                           <th>Receiver 1</th>\n                           <th>Receiver 2</th>\n                           <th>Receiver 3</th>\n                           <th>Gateway</th>\n\n                        </tr>\n                     </thead>\n                     <tbody>\n                        {this.renderTableData2()}\n                     </tbody>\n               \n               </Table>\n\n\n\n            </div>\n         )\n      }\n\n      return (\n         <div></div>\n      )\n   }\n\n}\n\nexport default TableDashboardSystem"]},"metadata":{},"sourceType":"module"}