{"ast":null,"code":"var _jsxFileName = \"/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/src/components/analysis.js\";\nimport React, { Component } from 'react';\nimport 'firebase/database';\nimport * as firebase from 'firebase/app';\nconst beaconlist = {\n  \"c2af522362be\": \"Client A\",\n  \"e20200bc8540\": \"Client B\"\n};\n\nclass Analysis extends React.Component {\n  constructor(props) {\n    super(props);\n    const beaconlist = {\n      \"c2af522362be\": \"Client A\",\n      \"e20200bc8540\": \"Client B\"\n    };\n    var self = this;\n    this.state = {\n      beaconlist: [{\n        id: \"c2af522362be\",\n        name: \"Client A\",\n        timeLeftHistory: {},\n        numberOfLeft: 0,\n        category: \"good\"\n      }, {\n        id: \"e20200bc8540\",\n        name: \"Client A\",\n        timeLeftHistory: {},\n        numberOfLeft: 0,\n        category: \"good\"\n      }],\n      thresholdCategory: [{\n        threshold: 0,\n        valueMsg: \"Low Risk\"\n      }, {\n        threshold: 1,\n        valueMsg: \"Medium Risk\"\n      }, {\n        threshold: 2,\n        valueMsg: \"High Risk\"\n      }],\n      data: ''\n    };\n    var recentPostsRef = firebase.database().ref('/deployment');\n    recentPostsRef.once('value').then(snapshot => {\n      // snapshot.val() is the dictionary with all your keys/values from the '/store' path\n      this.setState({\n        data: snapshot.val()\n      }, () => {\n        this.generateData();\n      });\n    }); // const rootRef = firebase.database().ref();\n    // const beaconRef = rootRef.child('deployment');\n    // const tableval = beaconRef.limitToLast(100).on('child_added',function(snapshot){\n    //     var data = snapshot.val();\n    //     console.log(data);\n    //     console.log(beaconlist[0]);\n    //     var beacon_1 = data[Object.keys(beaconlist)[0]];\n    //     var beacon_2 = data[Object.keys(beaconlist)[1]];\n    //     console.log(beacon_1);\n    //     self.setState({\n    //         beaconArray:[\n    //           { id: beacon_1.id,\n    //              lastSeen: beacon_1.lastSeen, \n    //              rssi_da1: beacon_1.rssi_da1, \n    //              lastSeen_da1: beacon_1.lastSeen_da1,\n    //              rssi_ma1: beacon_1.rssi_ma1,\n    //              last_seen_ma1: beacon_1.last_seen_ma1,\n    //              rssi_r1: beacon_1.rssi_r1,\n    //              last_seen_r1: beacon_1.last_seen_r1, \n    //              statusMsg: beacon_1.statusMsg },\n    //              { id: beacon_2.id,\n    //                 lastSeen: beacon_2.lastSeen, \n    //                 rssi_da1: beacon_2.rssi_da1, \n    //                 lastSeen_da1: beacon_2.lastSeen_da1,\n    //                 rssi_ma1: beacon_2.rssi_ma1,\n    //                 last_seen_ma1: beacon_2.last_seen_ma1,\n    //                 rssi_r1: beacon_2.rssi_r1,\n    //                 last_seen_r1: beacon_2.last_seen_r1, \n    //                 statusMsg: beacon_2.statusMsg }\n    //          ]\n    //     })\n    // }); \n  }\n\n  render() {\n    console.log(this.state);\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    });\n  } // renderTableHeader() {\n  //     let header = Object.keys(this.state.beaconArray)\n  //     return header.map((key, index) => {\n  //         return <th key={index}>{key.toUpperCase()}</th>\n  //     })\n  // }\n  // renderTableData() {\n  //     return this.state.beaconArray.map((beaconArray, index) => {\n  //         const { id, lastSeen, rssi_da1, lastSeen_da1, rssi_da2, lastSeen_da2, statusMsg } = beaconArray //destructuring\n  //         var d = JSON.parse(lastSeen)\n  //         var x = new Date(d);\n  //         console.log(x);\n  //         return (\n  //             <tr key={id}>\n  //                 <td>{beaconlist[id]}</td>\n  //                 <td>{id}</td>\n  //                 <td>{x.toString()}</td>\n  //                 <td>{statusMsg}</td>\n  //             </tr>\n  //         )\n  //     })\n  // }\n  // render() {\n  //     return (\n  //         <div>\n  //             <h1 id='title'>Client Monitoring Dashboard</h1>\n  //             <table id='beacon'>\n  //                 <tbody>\n  //                     {/* <tr>{this.renderTableHeader()}</tr> */}\n  //                     <tr>\n  //                         <th>Name</th>\n  //                         <th>ID</th>\n  //                         <th>Last Seen</th>\n  //                         <th>Status Message</th>\n  //                     </tr>\n  //                     {this.renderTableData()}\n  //                 </tbody>\n  //             </table>\n  //         </div>\n  //     )\n  // }\n\n\n  generateData() {\n    console.log(this.state.beaconlist);\n    var data = this.state.data;\n    var beaconlist = this.state.beaconlist;\n    var entries = Object.entries(data); // console.log(entries)\n\n    for (let i = 0; i < entries.length; i++) {\n      // console.log(data[i]);\n      var data = entries[i][1]; // to geth the object of beacons and its value\n\n      console.log(data); // const { id, lastSeen, rssi_da1,lastSeen_da1, rssi_da2, lastSeen_da2, statusMsg} = beaconArray //destructuring\n      // var d = JSON.parse(lastSeen)\n      // var x = new Date(d);\n\n      for (let j = 0; j < beaconlist.length; j++) {\n        console.log(data); //value of current beaconin the beaconlist\n\n        var beacon = beaconlist[j];\n        var beaconid = beacon.id;\n        console.log(beaconid);\n        var timeLeftHistory = beacon.timeLeftHistory; // array of timeLeftHistory\n\n        var noOfLeft = beacon.numberOfLeft;\n        var t = \"e20200bc8540\"; //value of beacon from data in firebase\n\n        var beaconData = data[t];\n        console.log(beaconData); // var lastSeenData = beaconData.lastSeen;\n        // var statusMsgData = beaconData.statusMsg;\n        // if(timeLeftHistory.includes(lastSeenData)){\n        //     if(statusMsgData == \"left\"){\n        //         noOfLeft += 1;\n        //         timeLeftHistory.push(lastSeenData);\n        //     }\n        // } \n      }\n    }\n  }\n\n}\n\nexport default Analysis;","map":{"version":3,"sources":["/Users/syukrirahiman/OneDrive - Singapore Management University/React/iot-test/src/components/analysis.js"],"names":["React","Component","firebase","beaconlist","Analysis","constructor","props","self","state","id","name","timeLeftHistory","numberOfLeft","category","thresholdCategory","threshold","valueMsg","data","recentPostsRef","database","ref","once","then","snapshot","setState","val","generateData","render","console","log","entries","Object","i","length","j","beacon","beaconid","noOfLeft","t","beaconData"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport 'firebase/database';\nimport * as firebase from 'firebase/app'\nconst beaconlist = { \"c2af522362be\": \"Client A\", \"e20200bc8540\": \"Client B\" }\nclass Analysis extends React.Component {\n    constructor(props) {\n        super(props)\n        const beaconlist = { \"c2af522362be\": \"Client A\", \"e20200bc8540\": \"Client B\" }\n        var self = this;\n\n        this.state = {\n            beaconlist: [\n                {   id: \"c2af522362be\",\n                    name: \"Client A\",\n                    timeLeftHistory: {},\n                    numberOfLeft: 0,\n                    category: \"good\"\n                },\n                {   id: \"e20200bc8540\",\n                    name: \"Client A\",\n                    timeLeftHistory: {},\n                    numberOfLeft: 0,\n                    category: \"good\"\n                }\n            ],\n\n            thresholdCategory: [\n                { \n                  threshold: 0, \n                  valueMsg: \"Low Risk\"\n                },\n                {\n                    threshold: 1,\n                    valueMsg: \"Medium Risk\"\n                },\n                {\n                    threshold: 2,\n                    valueMsg: \"High Risk\"\n                }\n        ],\n            data: ''\n        }\n\n        var recentPostsRef = firebase.database().ref('/deployment');\n        recentPostsRef.once('value').then(snapshot => {\n            // snapshot.val() is the dictionary with all your keys/values from the '/store' path\n            this.setState({\n                data: snapshot.val()\n            }, () => {\n\n                this.generateData();\n            })\n        });\n        // const rootRef = firebase.database().ref();\n        // const beaconRef = rootRef.child('deployment');\n        // const tableval = beaconRef.limitToLast(100).on('child_added',function(snapshot){\n        //     var data = snapshot.val();\n\n        //     console.log(data);\n        //     console.log(beaconlist[0]);\n        //     var beacon_1 = data[Object.keys(beaconlist)[0]];\n        //     var beacon_2 = data[Object.keys(beaconlist)[1]];\n        //     console.log(beacon_1);\n\n        //     self.setState({\n        //         beaconArray:[\n        //           { id: beacon_1.id,\n        //              lastSeen: beacon_1.lastSeen, \n        //              rssi_da1: beacon_1.rssi_da1, \n        //              lastSeen_da1: beacon_1.lastSeen_da1,\n        //              rssi_ma1: beacon_1.rssi_ma1,\n        //              last_seen_ma1: beacon_1.last_seen_ma1,\n        //              rssi_r1: beacon_1.rssi_r1,\n        //              last_seen_r1: beacon_1.last_seen_r1, \n        //              statusMsg: beacon_1.statusMsg },\n\n        //              { id: beacon_2.id,\n        //                 lastSeen: beacon_2.lastSeen, \n        //                 rssi_da1: beacon_2.rssi_da1, \n        //                 lastSeen_da1: beacon_2.lastSeen_da1,\n        //                 rssi_ma1: beacon_2.rssi_ma1,\n        //                 last_seen_ma1: beacon_2.last_seen_ma1,\n        //                 rssi_r1: beacon_2.rssi_r1,\n        //                 last_seen_r1: beacon_2.last_seen_r1, \n        //                 statusMsg: beacon_2.statusMsg }\n\n        //          ]\n\n        //     })\n\n        // }); \n\n\n    }\n\n    render() {\n\n        console.log(this.state)\n\n        return (\n\n            <div></div>\n\n        )\n\n    }\n    // renderTableHeader() {\n\n    //     let header = Object.keys(this.state.beaconArray)\n    //     return header.map((key, index) => {\n    //         return <th key={index}>{key.toUpperCase()}</th>\n    //     })\n    // }\n\n    // renderTableData() {\n\n    //     return this.state.beaconArray.map((beaconArray, index) => {\n    //         const { id, lastSeen, rssi_da1, lastSeen_da1, rssi_da2, lastSeen_da2, statusMsg } = beaconArray //destructuring\n    //         var d = JSON.parse(lastSeen)\n    //         var x = new Date(d);\n    //         console.log(x);\n\n    //         return (\n    //             <tr key={id}>\n    //                 <td>{beaconlist[id]}</td>\n    //                 <td>{id}</td>\n    //                 <td>{x.toString()}</td>\n    //                 <td>{statusMsg}</td>\n    //             </tr>\n    //         )\n    //     })\n    // }\n\n    // render() {\n    //     return (\n    //         <div>\n    //             <h1 id='title'>Client Monitoring Dashboard</h1>\n    //             <table id='beacon'>\n    //                 <tbody>\n    //                     {/* <tr>{this.renderTableHeader()}</tr> */}\n    //                     <tr>\n    //                         <th>Name</th>\n    //                         <th>ID</th>\n    //                         <th>Last Seen</th>\n    //                         <th>Status Message</th>\n    //                     </tr>\n    //                     {this.renderTableData()}\n    //                 </tbody>\n    //             </table>\n    //         </div>\n    //     )\n    // }\n\n    generateData() {\n        console.log(this.state.beaconlist);\n        var data = this.state.data;\n\n        var beaconlist = this.state.beaconlist;\n\n        var entries = Object.entries(data)\n\n        // console.log(entries)\n        \n        for(let i = 0; i < entries.length;  i++){\n            // console.log(data[i]);\n\n            var data = entries[i][1] // to geth the object of beacons and its value\n            console.log(data);\n  \n            // const { id, lastSeen, rssi_da1,lastSeen_da1, rssi_da2, lastSeen_da2, statusMsg} = beaconArray //destructuring\n\n            // var d = JSON.parse(lastSeen)\n            // var x = new Date(d);\n\n            for(let j = 0; j < beaconlist.length; j++){\n                console.log(data)\n\n                //value of current beaconin the beaconlist\n                var beacon = beaconlist[j];\n                var beaconid = beacon.id;\n                console.log(beaconid)\n                var timeLeftHistory = beacon.timeLeftHistory; // array of timeLeftHistory\n                var noOfLeft = beacon.numberOfLeft; \n\n                var t = \"e20200bc8540\";\n\n                //value of beacon from data in firebase\n                var beaconData = data[t];\n                console.log(beaconData)\n                // var lastSeenData = beaconData.lastSeen;\n                // var statusMsgData = beaconData.statusMsg;\n\n                // if(timeLeftHistory.includes(lastSeenData)){\n                //     if(statusMsgData == \"left\"){\n                //         noOfLeft += 1;\n                //         timeLeftHistory.push(lastSeenData);\n                //     }\n                // } \n\n            }\n          \n\n        }\n    }\n\n}\n\nexport default Analysis"]},"metadata":{},"sourceType":"module"}